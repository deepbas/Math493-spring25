{
  "hash": "318816ba4a9d9eff4c95633388a2968f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity20\"\nformat: html\nwarning: false\nmessage: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time Series Essentials, install if needed!\nlibrary(feasts)       # Feature extraction & decomposition\nlibrary(fable)        # Forecasting models (ARIMA, ETS, etc.)\nlibrary(fpp3)         # Tidy time series dataseta\nlibrary(astsa)        # Applied statistical TS methods from textbook\nlibrary(tseries)      # Unit root tests & TS diagnostics\nlibrary(tsibbledata)  # Curated TS datasets\nlibrary(quantmod)     # Financial data retrieval\nlibrary(tidyquant)    # Financial analysis in tidyverse\nlibrary(purrr)        # Functional programming for TS pipelines\nlibrary(readr)        # Efficient data import\n```\n:::\n\n\n**Cross-Correlation & Multiserial Dynamics**  \n\n*Objective: Analyze lead-lag relationships between series*\n\nThe cross-correlation function at lag k is given by:\n\n$$\n\\rho_{XY}(k) = \\frac{\\gamma_{XY}(k)}{\\sqrt{\\gamma_{XX}(0)\\,\\gamma_{YY}(0)}}\n$$\n\nwhere:\n\n - $\\gamma_{XY}(k)$ is the cross-covariance at lag k between series X and Y\n - $\\gamma_{XX}(0)$ and $\\gamma_{YY}(0)$ are the variances (covariance at lag 0)\n   of X and Y, respectively\n - $\\rho_{XY}(k)$ thus ranges between -1 and +1\n\n\n\n### How to interpret the CCF?\n\nThe CCF at lag k measures how strongly the current values of one series correlate with the values of the other series shifted by k time steps.\n\n- Positive lag (k > 0) indicates how much the first series LEADS the second.\n- Negative lag (k < 0) indicates how much the second series LEADS the first.\n- A high absolute value of CCF at a particular lag suggests a strong\n lead-lag relationship at that time shift.\n\n\n### 1.1 CCF Analysis with `pelt`\n\n::: {.cell}\n\n```{.r .cell-code}\npelt |> \n  as_tsibble() |>\n  CCF(Lynx, Hare) |> \n  autoplot() +\n  labs(title = \"Hare peaks lead Lynx by 1-2 years (predator-prey dynamics)\")\n```\n\n::: {.cell-output-display}\n![](activity20_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n- A single cross-correlation plot is sufficient for understanding how two time series move relative to each other over different time shifts.\n\n- Peaks at positive lags suggest that the first series' changes come before changes in the second series (leading). Peaks at negative lags suggest the second series leads the first.\n\n- In ecological contexts (like hare vs. lynx), a positive lag at which the CCF is high might mean prey population spikes occur 1-2 years before predator population spikes.\n\n\n### 1.2 Spurious Correlation Caveat\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulate independent series\nset.seed(123)\nfake_data <- tsibble(t=1:100, x=rnorm(100), y=rnorm(100), index=t)\nfake_data |> \n  CCF(x,y) |> autoplot()\n```\n\n::: {.cell-output-display}\n![](activity20_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n**Critical Thinking**: Even independent series may show \"significant\" correlations by chance. Always validate with domain knowledge.\n\n\n**Simulation & Model Identification**  \n\n*Hands-on ARMA process experimentation*\n\n### 1.3 AR(2) Simulation & Diagnostics\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_ar2 <- arima.sim(n=200, list(ar=c(0.6, -0.3))) \n\nsim_ar2 |> \n  as_tsibble() |>\n  ACF() |> \n  autoplot() # Decaying oscillations\n```\n\n::: {.cell-output-display}\n![](activity20_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsim_ar2 |> \n  as_tsibble() |>\n  PACF() |> \n  autoplot() # Spikes at lags 1-2\n```\n\n::: {.cell-output-display}\n![](activity20_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n### 1.4 MA(1) Characteristics\n\n::: {.cell}\n\n```{.r .cell-code}\nsim_ma1 <- arima.sim(n=200, list(ma=0.8))\n\nsim_ma1 |> \n  as_tsibble() |>\n  ACF() |> \n  autoplot() # Cutoff after lag 1\n```\n\n::: {.cell-output-display}\n![](activity20_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsim_ma1 |> \n  as_tsibble() |>\n  PACF() |> \n  autoplot() # Exponential decay\n```\n\n::: {.cell-output-display}\n![](activity20_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n**Golden Rule**:  \n\n- AR(p): PACF significant for first p lags  \n- MA(q): ACF significant for first q lags  \n- ARMA: Both decay gradually\n",
    "supporting": [
      "activity20_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}