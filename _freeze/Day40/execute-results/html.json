{
  "hash": "70750f87ac3d0e076d5dd72970378dfd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Day 40\"\ntitle-slide-attributes:\n  data-background-image: images/lake.jpg\n  data-background-size: contain\n  data-background-opacity: \"0.5\"\nsubtitle: \"Math 216: Statistical Thinking\"\nauthor: \"Bastola\"\nformat:\n  revealjs:\n    html-math-method: mathjax\n    mathjax-url: \"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/MathJax.js\" \n    theme: [default, scss/main.scss]\n    slide-number: true\n    preview-links: auto\n    history: true\n    chalkboard: \n      src: drawings.json\n    transition: slide\n    background-transition: fade    \n    touch: false\n    controls: true\n---\n\n\n\n\n\n\n## Blood Alcohol Content (BAC) {.font40}\n\n::: row\n\n::: left\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|  X| ID_OSU|Gender | Weight| Beers|   BAC|\n|--:|------:|:------|------:|-----:|-----:|\n|  1|      1|female |    132|     5| 0.100|\n|  2|      2|female |    128|     2| 0.030|\n|  3|      3|female |    110|     9| 0.190|\n|  4|      4|male   |    192|     8| 0.120|\n|  5|      5|male   |    172|     3| 0.040|\n|  6|      6|female |    250|     7| 0.095|\n|  7|      7|female |    125|     3| 0.070|\n|  8|      8|male   |    175|     5| 0.060|\n|  9|      9|female |    175|     3| 0.020|\n| 10|     10|male   |    275|     5| 0.050|\n| 11|     11|female |    130|     4| 0.070|\n| 12|     12|male   |    168|     6| 0.100|\n| 13|     13|female |    128|     5| 0.085|\n| 14|     14|male   |    246|     7| 0.090|\n| 15|     15|male   |    164|     1| 0.010|\n| 16|     16|male   |    175|     4| 0.050|\n\n\n:::\n:::\n\n\n\n:::\n\n::: right\n\n<br>\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Day40_files/figure-revealjs/unnamed-chunk-2-1.png){width=140%}\n:::\n:::\n\n\n\n\n:::\n:::\n\n## Simple Linear Regression: Linear Regression of BAC (y) on Beers (x) {.font70}\n\n::: cle1\n$$\n\\begin{align*}\n\\widehat{BAC} &=-0.0127+0.0180(\\text{Beers})\\\\\n\\hat{\\sigma} &= 0.02044\n\\end{align*}\n$$\n:::\n\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = BAC ~ Beers, data = bac)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.027118 -0.017350  0.001773  0.008623  0.041027 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.012701   0.012638  -1.005    0.332    \nBeers        0.017964   0.002402   7.480 2.97e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.02044 on 14 degrees of freedom\nMultiple R-squared:  0.7998,\tAdjusted R-squared:  0.7855 \nF-statistic: 55.94 on 1 and 14 DF,  p-value: 2.969e-06\n```\n\n\n:::\n:::\n\n\n\n\n## Confidence Interval {.font80}\n\n::: cle6\n$$\nC\\% \\text{ confidence interval for } \\beta_i \\text{ is } \\hat{\\beta}_i \\pm t^* \\operatorname{SE}(\\hat{\\beta}_i)\n$$\n\n- Get CIs for slope/intercept with `confint` command or compute using `qt(.975, df= )` to get t* for 95% CI\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(bac.lm)  # 95% C.I.\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  2.5 %     97.5 %\n(Intercept) -0.03980535 0.01440414\nBeers        0.01281262 0.02311490\n```\n\n\n:::\n:::\n\n\n\n\n## Inference for slope (effect of Beers on BAC) {.font80}\n\n::: cle6\n$$\n\\begin{align*}\n\\mathrm{H}_0: &\\ \\beta_i = 0 & \\text{(no effect for predictor i)} \\\\\n\\mathrm{H}_A: &\\ \\beta_i \\neq 0 & \\text{(predictor i has an effect on y)}\n\\end{align*}\n$$\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nknitr::kable(tidy(bac.lm))\n```\n\n::: {.cell-output-display}\n\n\n|term        |   estimate| std.error| statistic|   p.value|\n|:-----------|----------:|---------:|---------:|---------:|\n|(Intercept) | -0.0127006| 0.0126375| -1.004993| 0.3319551|\n|Beers       |  0.0179638| 0.0024017|  7.479592| 0.0000030|\n\n\n:::\n:::\n\n\n\n\n\n## Multiple Regression: Include More Predictors (Explanatory Variables) {.font80}\n\nSuppose you have $p$ explanatory variables. The mean of Y is a linear function of $\\boldsymbol{x}_1, \\boldsymbol{x}_2, \\ldots, \\boldsymbol{x}_p$.\n\n\n::: cle6\n$$\n E(Y \\mid X) = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\cdots + \\beta_p X_p\n$$\n:::\n\n## Scatterplot Matrix for BAC Example {.font80}\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\nggpairs(bac[, -c(1,2,3)]) + theme(axis.text.x = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![](Day40_files/figure-revealjs/unnamed-chunk-6-1.png){width=960}\n:::\n:::\n\n\n\n\n\n## Regression of BAC on Beers and Weight {.font70}\n\nThe fitted model for BAC is:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1.bac <- lm(BAC ~ Beers + Weight, data = bac) # fit the model\nsummary(lm1.bac)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = BAC ~ Beers + Weight, data = bac)\n\nResiduals:\n       Min         1Q     Median         3Q        Max \n-0.0162968 -0.0067796  0.0003985  0.0085287  0.0155621 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.986e-02  1.043e-02   3.821  0.00212 ** \nBeers        1.998e-02  1.263e-03  15.817 7.16e-10 ***\nWeight      -3.628e-04  5.668e-05  -6.401 2.34e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01041 on 13 degrees of freedom\nMultiple R-squared:  0.9518,\tAdjusted R-squared:  0.9444 \nF-statistic: 128.3 on 2 and 13 DF,  p-value: 2.756e-09\n```\n\n\n:::\n:::\n\n\n\n\n$$\n\\widehat{BAC} =  0.0399 + 0.0200 (\\text{Beers}) - 0.00036 (\\text{Weight}).\n$$\n\n\n## Regression of BAC on Beers and Weight {.font80}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(tidy(lm1.bac))\n```\n\n::: {.cell-output-display}\n\n\n|term        |   estimate| std.error| statistic|   p.value|\n|:-----------|----------:|---------:|---------:|---------:|\n|(Intercept) |  0.0398634| 0.0104333|  3.820787| 0.0021219|\n|Beers       |  0.0199757| 0.0012629| 15.817343| 0.0000000|\n|Weight      | -0.0003628| 0.0000567| -6.401230| 0.0000234|\n\n\n:::\n\n```{.r .cell-code}\nknitr::kable(confint(lm1.bac))\n```\n\n::: {.cell-output-display}\n\n\n|            |      2.5 %|     97.5 %|\n|:-----------|----------:|----------:|\n|(Intercept) |  0.0173236|  0.0624031|\n|Beers       |  0.0172474|  0.0227040|\n|Weight      | -0.0004853| -0.0002404|\n\n\n:::\n:::\n\n\n\n\n\n## Regression of BAC on Beers, Weight, and Gender {.font80}\n\n::: cle6\n$$\n\\widehat{BAC} = 0.039 + 0.020 (\\text{Beers}) - 0.00034 (\\text{Weight}) - 0.0032 \\text{ (Male)}\n$$\n:::\n\nBoth number of beers and weight are statistically significant predictors of BAC (p-value < 0.0001). Holding weight constant, we are 95\\% confident that the true effect of drinking one more beer is a 0.017 to 0.023 unit increase in mean BAC.\n\n## Scatterplot Matrix for BAC Example {.font80}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\nggpairs(bac[, -c(1,2)]) + theme(axis.text.x = element_text(size = 12))\n```\n\n::: {.cell-output-display}\n![](Day40_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n\n\n\n## Regression for BAC on Beers, Weight, and Gender {.font70}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2.bac <- lm(BAC ~ Beers + Weight + Gender, data = bac) # fit the model\nsummary(lm2.bac)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = BAC ~ Beers + Weight + Gender, data = bac)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.018125 -0.005713  0.001501  0.007896  0.014655 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.871e-02  1.097e-02   3.528 0.004164 ** \nBeers        1.990e-02  1.309e-03  15.196 3.35e-09 ***\nWeight      -3.444e-04  6.842e-05  -5.034 0.000292 ***\nGendermale  -3.240e-03  6.286e-03  -0.515 0.615584    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.01072 on 12 degrees of freedom\nMultiple R-squared:  0.9528,\tAdjusted R-squared:  0.941 \nF-statistic: 80.81 on 3 and 12 DF,  p-value: 3.162e-08\n```\n\n\n:::\n:::\n\n\n\n## Regression Details for BAC on Beers, Weight, and Gender {.font60}\n\n::: cle6\n\"Male\" is an indicator variable that equals 1 when predicting male Blood Alcohol Content (BAC) and 0 for female.\n\n1. **Barb's Prediction**\n   - **Context**: Barb drank 4 beers, weighs 160 lbs, and is female.\n   - **Equation**:\n     $$\n     \\widehat{BAC} = 0.039 + 0.020(4) - 0.00034(160) - 0.0032(0) = 0.0646\n     $$\n\n2. **John's Prediction**\n   - **Context**: John drank 4 beers, weighs 160 lbs, and is male.\n   - **Equation**:\n     $$\n     \\widehat{BAC} = 0.039 + 0.020(4) - 0.00034(160) - 0.0032(1) = 0.0614\n     $$\n\n:::\n\n\n## Model Disgnostics {.font80}\n\n::: row\n::: left\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(lm2.bac, which=1)\n```\n\n::: {.cell-output-display}\n![](Day40_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n\n\n:::\n\n::: right\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(lm2.bac, which=2)\n```\n\n::: {.cell-output-display}\n![](Day40_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n\n:::\n:::\n\n\n\n\n\n\n",
    "supporting": [
      "Day40_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}